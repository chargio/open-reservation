{% extends 'base.html' %}

{% block content %}
<h1><b>Elija un turno de los disponibles para {{ offspring }}:</b></h1>
<p>Su elección sustituirá a la anterior (si existe)</p>

{% regroup schedules by room as room_list %}

{% for room in room_list %}
  <div class="col-xs-12">
    <div class="panel panel-info">
      <div class="panel-heading">
        <div class="panel-title">
          <strong> Room: {{ room.grouper }} </strong>
        </div>
      </div>
    </div>
  </div> 
  <div class="container-fluid">
    <table class="table table-striped table-bordered">
        <thead>
            <tr>
                {% for day in used_days_of_week %}
                  <th>
                      {{ day.display_name }}
                  </th>
                {% endfor %}
            </tr>
          </thead>
          <tbody>
              {% for start_time in used_starting_times %} 
              <tr>
                  {% for day in used_days_of_week %}
                  <td>
                    {% for schedule in room.list %}
                      
                      {% if schedule.day_of_week == day.day_of_week and schedule.start_time == start_time.start_time and schedule.seats_available%}
                          <form method="post" action="{% url 'offsprings:createassignment' offspring.id schedule.id %}">
                              {% csrf_token %}
                              {{ schedule }}
                              <span class="badge">{{ schedule.seats_available}}</span>
                              <input type="submit" value="Seleccionar" class="btn btn-small"/>
                          </form>
                      {% endif %}
                    
                    {% endfor %}
                  </td>
                  {% endfor %} 

              </tr>
              {% endfor %}   
            </tbody>
    </table>
    </div>

{% endfor %}

{% endblock %}